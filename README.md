# Malware Detection
![alt train example](resources/train.png)

## Description
malware detection.py classifies portable executable (PE) as malware or goodware using PE import data from the PE Imports
dataset (https://www.kaggle.com/datasets/ang3loliveira/malware-analysis-datasets-top1000-pe-imports). These are
classified by using a decision tree, support vector machine, and a multilayer perceptron, three supervised learning
algorithms.

## Project Structure
```
Malware Detection
│   README.md
│   ...
│
└───data
│   │   pe_imports.csv*
│   │   training_data.csv*
│
└───src
    │   classify.py
    │   malware_detection.py
    │   preprocessing.py
    │   requirements.txt
    │   train.py
    │   update.py
    │
    └───models
    │   │   dt_model.pickle
    │   │   mlp_model.pickle
    │   │   svm_model.pickle
    │
    └───output
    │   │   dt_confusion_matrix.csv
    │   │   dt_rates.txt
    │   │   mlp_confusion_matrix.csv
    │   │   mlp_rates.txt
    │   │   svm_confusion_matrix.csv
    │   │   svm_rates.txt
    │   │
    │   
```

## Getting Started

### Dependencies
* Python3
* Colorama 
* Termcolor
* Pandas
* Sklearn
* Pickle

### Installing
```
# Clone this repository
$ git clone https://github.com/sea7321/malware-detection.git

# Go into the repository
$ cd malware-detection/src

# Install dependencies
$ pip install -r requirements.txt
```

### Executing program

```
# Run the intrusion detection system
$ python3 malware_detection.py
```

## Train Example

```
# Create, train, and save the models 
$ python3 malware_detection.py -t
```

![alt train_example](resources/train.png)

## Classify Example

```
# Classify new attack data on pre-saved models
$ python3 malware_detection.py -c <test_filename>
$ python3 malware_detection.py -c ../data/Hantaner.exe
```

![alt classify_example](resources/classify.png)

## Update Example

```
# Update data with a goodware/malware sample
$ python3 malware_detection.py -u <test_filename> <is_malware>
$ python3 malware_detection.py -u ../data/Hantaner.exe <true>
```

![alt update_example](resources/update_1.png)
![alt update_example](resources/update_2.png)

## Author
* Savannah Alfaro, sea2985@rit.edu